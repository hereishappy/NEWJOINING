<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Employee Intake — Mobile</title>
  <style>
    :root{--accent:#0ea5e9;--card:#fff;--bg:#f3f4f6;--muted:#6b7280}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);margin:0;padding:16px;color:#111827}
    .wrap{max-width:820px;margin:0 auto}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    h1{margin:0 0 6px 0;font-size:20px}
    .lead{margin:0 0 12px 0;color:var(--muted);font-size:14px}
    label{display:block;font-size:13px;color:#374151;margin:6px 0}
    input[type=text],input[type=date],input[type=number],select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e5e7eb;font-size:14px;box-sizing:border-box}
    .grid{display:grid;grid-template-columns:1fr;gap:8px}
    @media(min-width:640px){.grid-2{grid-template-columns:repeat(2,1fr)}}
    .file-row{display:flex;gap:8px;align-items:center}
    button{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:0;font-weight:600}
    button.ghost{background:#fff;color:#111;border:1px solid #e5e7eb}
    .muted{color:var(--muted);font-size:13px}
    .status{margin-top:10px;padding:10px;border-radius:8px;background:#f8fafc;font-size:13px}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Employee Intake Form</h1>
      <p class="lead">Mobile-friendly. All fields optional. Upload docs and submit.</p>

      <form id="frm">
        <div class="grid grid-2" id="fields">
          <!-- left column of fields -->
          <div>
            <label>Employee Name (As per Aadhaar)</label><input name="employeeName" type="text">
            <label>Date of Birth</label><input name="dob" type="date">
            <label>Blood Group</label><input name="bloodGroup" type="text">
            <label>Marital Status</label><input name="maritalStatus" type="text">
            <label>Father Name</label><input name="fatherName" type="text">
            <label>Permanent Address</label><textarea name="permanentAddress" rows="2"></textarea>
            <label>Contact No</label><input name="contactNo" type="text">
            <label>Emergency Contact No</label><input name="emergencyContactNo" type="text">
            <label>Employee Relation with Emergency Contact No</label><input name="employeeRelationWithEmergencyContactNo" type="text">
            <label>Name of Emergency Contact</label><input name="emergencyContactName" type="text">
          </div>

          <div>
            <label>State</label><input name="state" type="text">
            <label>Bank Name</label><input name="bankName" type="text">
            <label>Account No</label><input name="accountNo" type="text">
            <label>IFSC Code</label><input name="ifscCode" type="text">
            <label>UAN Number</label><input name="uanNumber" type="text">
            <label>ESI No / WC POLICY</label><input name="esiNo" type="text">
            <label>Aadhaar No</label><input name="aadhaarNo" type="text">
            <label>Mother Name</label><input name="motherName" type="text">
            <label>Mother Date of Birth</label><input name="motherDob" type="date">
            <label>Father DOB</label><input name="fatherDob" type="date">
          </div>

          <div>
            <label>Date of Marriage</label><input name="dateOfMarriage" type="date">
            <label>Wife Name</label><input name="wifeName" type="text">
            <label>Wife Date of Birth</label><input name="wifeDob" type="date">
            <label>No. Childrens</label><input name="noChildrens" type="number" min="0">
            <label>Child 1 Name</label><input name="child1Name" type="text">
            <label>Child 1 Son/Daughter</label>
            <select name="child1Relation"><option value="">Select</option><option>Son</option><option>Daughter</option></select>
            <label>Child 1 DOB</label><input name="child1Dob" type="date">
          </div>

          <div>
            <label>Child 2 Name</label><input name="child2Name" type="text">
            <label>Child 2 Son/Daughter</label><select name="child2Relation"><option value="">Select</option><option>Son</option><option>Daughter</option></select>
            <label>Child 2 DOB</label><input name="child2Dob" type="date">
            <label>Child 3 Name</label><input name="child3Name" type="text">
            <label>Child 3 Son/Daughter</label><select name="child3Relation"><option value="">Select</option><option>Son</option><option>Daughter</option></select>
            <label>Child 3 DOB</label><input name="child3Dob" type="date">
            <label>Education</label><input name="education" type="text">
            <label>Scaffolding Work Experience</label><input name="scaffoldingWorkExperience" type="text">
          </div>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid #eef2f7">

        <div>
          <label>Aadhaar Front (optional)</label><input type="file" name="aadhaarFront" accept="image/*,application/pdf">
          <label>Aadhaar Back (optional)</label><input type="file" name="aadhaarBack" accept="image/*,application/pdf">
          <label>Bank Passbook (optional)</label><input type="file" name="bankPassbook" accept="image/*,application/pdf">
          <label>Passport Photo (optional)</label><input type="file" name="passportPhoto" accept="image/*">
        </div>

        <div style="display:flex;gap:8px;margin-top:12px;align-items:center">
          <button id="submitBtn" type="button">Submit</button>
          <button id="resetBtn" type="button" class="ghost">Reset</button>
          <div id="msg" class="small muted" style="margin-left:8px"></div>
        </div>
      </form>

      <div id="status" class="status small" style="margin-top:10px">Ready.</div>
    </div>
  </div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwQF-wXDjpt6WfghxrPT8BCxcX-RP51QZHL9I41l5vYDR_r2aXKsYIhpW7D9N8KvfUi/exec'; // <--- set this

function $(s){return document.querySelector(s)}
function updateStatus(t){$('#status').textContent = t}
function showMsg(t){$('#msg').textContent = t}

async function fileToBase64(file){
  if(!file) return null;
  return new Promise((res, rej) => {
    const r = new FileReader();
    r.onload = ()=> {
      const dataUrl = r.result;
      // strip prefix
      const parts = dataUrl.split(',');
      res(parts[1]);
    };
    r.onerror = rej;
    r.readAsDataURL(file);
  });
}

function readForm(){
  const f = document.getElementById('frm');
  const fd = new FormData(f);
  const formObj = {};
  for(const [k,v] of fd){
    if(['aadhaarFront','aadhaarBack','bankPassbook','passportPhoto'].includes(k)) continue;
    formObj[k]=v?v.toString():'';
  }
  const files = {
    aadhaarFront: f.aadhaarFront.files[0]||null,
    aadhaarBack: f.aadhaarBack.files[0]||null,
    bankPassbook: f.bankPassbook.files[0]||null,
    passportPhoto: f.passportPhoto.files[0]||null
  };
  return { formObj, files };
}

document.getElementById('submitBtn').addEventListener('click', async ()=>{
  try {
    showMsg('');
    updateStatus('Preparing...');
    const { formObj, files } = readForm();

    // convert files
    const payloadFiles = {};
    for(const k of Object.keys(files)){
      const fi = files[k];
      if(fi){
        updateStatus('Encoding ' + fi.name);
        const b64 = await fileToBase64(fi);
        payloadFiles[k] = { name: fi.name, mime: fi.type, b64: b64 };
      }
    }

    const payload = { form: formObj, files: payloadFiles, timestamp: new Date().toISOString() };

    updateStatus('Sending to server...');
    const res = await fetch(SCRIPT_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    const data = await res.json();
    if(res.ok && data && data.success){
      updateStatus('Saved — serial ' + (data.serial || '—'));
      showMsg('Saved — serial ' + (data.serial || '—'));
      document.getElementById('frm').reset();
    } else {
      updateStatus('Error saving');
      showMsg('Error: ' + (data && data.error ? data.error : res.statusText));
    }
  } catch (err) {
    console.error(err);
    updateStatus('Submit failed');
    showMsg('Submit failed: ' + (err.message || err));
  }
});

document.getElementById('resetBtn').addEventListener('click', ()=>{ document.getElementById('frm').reset(); showMsg(''); updateStatus('Ready.') })
</script>
</body>
</html>
